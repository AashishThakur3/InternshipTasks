-- Database: CRMT

-- DROP DATABASE IF EXISTS "CRMT";

CREATE DATABASE "CRMT"
    WITH 
    OWNER = postgres
    ENCODING = 'UTF8'
    LC_COLLATE = 'C'
    LC_CTYPE = 'C'
    TABLESPACE = pg_default
    CONNECTION LIMIT = -1;
	
--Creating Tables	
CREATE TABLE person(
	person_id int primary key,
	first_name varchar(25) not null,
	last_name varchar(25) not null,
	gender char(1) not null,	
	date_of_birth date,
	email varchar(32),
	contact_no bigint not null,
    address  varchar(35) 
);


CREATE TABLE plan(
	plan_id int primary key,
	plan_name varchar(20) not null,	
	plan_validity varchar(30) not null,
	plan_data varchar(20) not null,
	plan_price char(15) not null 
);


CREATE TABLE leads(
	lead_id int primary key,
	created_at date not null,
	person_id int references person(person_id)
);


CREATE TABLE opportunity(
	opportunity_id int primary key,
	created_at date not null,
	emp_id int , 
	lead_id int references lead(lead_id),
	plan_id int references plan(plan_id)
);


CREATE TABLE customer(
	customer_id int primary key,
	cust_username varchar(25) not null,
	cust_password varchar(25) not null,
	ac_details varchar(20) not null,
	opportunity_id int references opportunity(opportunity_id),
	plan_id int references plan(plan_id)
);


CREATE TABLE employee(
	emp_id int primary key,
	designation varchar(30) not null,
	person_id int references person(person_id),
	customer_id int references customer(customer_id)
);


CREATE TABLE task(
	task_id int primary key,
	task_name varchar(25) not null,
	task_desc varchar(25) not null,
	task_status varchar(20) not null,
	start_date date,
	expected_end_date date,
	actual_end_date date,
	assigned_by varchar(25) not null,
	module_id int not null,
	module_name varchar(20),
	emp_id int references employee(emp_id)
);
